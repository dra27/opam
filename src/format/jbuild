(* -*- tuareg -*- *)

#use "../jbuild.common"

let () = out {|
(jbuild_version 1)

(library
  ((name opam_format)
   (public_name opam-format)
   (synopsis "OCaml Package Manager file format handling library")
   (libraries (opam-core opam-file-format re.pcre re.posix))
   (flags (:standard %s))
   (wrapped false)))

(ocamllex (opamLineLexer opamInterpLexer))

(rule
  (with-stdout-to opamTypes.ml
    (progn
      (echo "module rec OpamTypes : sig\n")
      (cat opamTypes.mli)
      (echo "\nend = OpamTypes\ninclude OpamTypes\n"))))
|} ocaml_flags
